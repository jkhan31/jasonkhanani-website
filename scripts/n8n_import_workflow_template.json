{
  "name": "Import Google Docs -> convert -> PR",
  "nodes": [
    {
      "type": "n8n-nodes-base.webhook",
      "name": "Webhook (Google Docs)",
      "credentials": {},
      "parameters": {
        "httpMethod": "POST",
        "path": "google-doc-import",
        "responseMode": "onReceived",
        "options": {}
      }
    },
    {
      "type": "n8n-nodes-base.if",
      "name": "Check Secret",
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$json[\"headers\"][\"x-import-secret\"]}}",
              "operation": "equal",
              "value2": "={{$env.N8N_IMPORT_SECRET}}"
            }
          ]
        }
      }
    },
    {
      "type": "n8n-nodes-base.writeBinaryFile",
      "name": "Save file",
      "parameters": {
        "filePath": "/tmp/{{ $binary.file.metadata.filename || $json.title || 'doc' }}",
        "binaryPropertyName": "file"
      }
    },
    {
      "type": "n8n-nodes-base.executeCommand",
      "name": "Run converter",
      "parameters": {
        "command": "node",
        "args": ["./scripts/convert-docx.js", "/tmp/{{ $binary.file.metadata.filename }}", "{{ $json.title }}"]
      }
    },
    {
      "type": "n8n-nodes-base.exec",
      "name": "Git commit + PR (placeholder)",
      "parameters": {
        "command": "sh",
        "args": ["-lc", "./scripts/git-commit-and-pr.sh \"{{ $json.title }}\""]
      }
    }
  ],
  "connections": {
    "Webhook (Google Docs)": {
      "main": [
        [
          {
            "node": "Check Secret",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Secret": {
      "main": [
        [
          {
            "node": "Save file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save file": {
      "main": [
        [
          {
            "node": "Run converter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Run converter": {
      "main": [
        [
          {
            "node": "Git commit + PR (placeholder)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}

/*
  Notes:
  - This is a template skeleton for n8n import. Import into n8n and connect real credentials.
  - Create an environment variable N8N_IMPORT_SECRET in n8n and set the same value in your Apps Script header.
  - Implement `git-commit-and-pr.sh` on the host or replace the placeholder node with the GitHub nodes to commit files and open a PR.
*/
